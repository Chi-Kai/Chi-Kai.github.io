---
title: "区块链学习"
date: 2022-11-28T11:08:17+08:00
draft: true
---

## BTC 

### 密码学原理

#### 哈希

- **collision resistance** (这里指哈希碰撞) : 
  
	例如 x≠y H(x)=H(y) 两个不同的输入，输出却是相等的，这就称哈希碰撞。它是不可避免的，因为输入空间总大于输出空间。
	
	给出x，很难找到y，除非蛮力求解(brute-force)。

	该性质的作用:对一个message求digest

	比如message取m m的哈希值是H(m)=digest 如果有人想篡改m值而H(m)不变，则无法做到。

	collision resistance无法验证，是根据实践经验得来的。

- **hiding** : 
  
	哈希函数的计算过程是单向的，不可逆的。无法从哈希值推出输入内容。

	前提是**输入空间足够大，分布均匀**。否则可能被蛮力破解。可以在输入后面拼接一个随机数来取hash,保证输入足够大。

	该性质的作用:和collision resistance 结合在一起，用来实现**digital commitment**(又称为digital equivalent of a sealed envelope)。把预测结果作为输入x，算出一个哈希值，将哈希值公布，hiding让人们知道哈希值而不知道预测值，最后再将x公布，因为有collision resistance的性质，预测结果是不可篡改的。 

- **puzzle friendly** :
  
	哈希值事先不可预测，仅仅根据输入很难预测输出。在比特币中采用SHA-256哈希函数，需要一个哈希值，存在于某一个范围内，只能通过不停运算查找出来。该性质保证了比特币系统中，只能通过“挖矿”获得比特币。也就是说，该性质保证了工作量证明(POW)机制可以运行下去【“挖矿难，但验证易”】。

#### 签名

比特币中账户管理 在第三方中心化系统中，账户开通依赖于第三方。但去中心化的比特币系统中，很明显不能
进行“申请账户”。在比特币系统中，申请账户是用户自己来处理的，即自己创建一个公钥-私钥对。（关于公私
钥请自行了解非对称加密体系和对称加密体系） 公钥和私钥的应用保证了“签名”的应用。当在比特币网络中进
行转账时，通过“签名”可以明确是由哪个账户转出的，从而防止不良分子对其他账户比特币的盗取。 在发布交
易时，通过自己私钥签名，其他人可以根据公钥进行验证，从而保证该交易由自己发起。也就是说，只有拥有
私钥，才能将该账户中的比特币转走。 【注意：比特币系统中，很难通过生成大量公私钥对来获取他人私钥】

### 数据结构

#### hash pointer (哈希指针)

![](https://s2.loli.net/2022/11/28/8ReVK2i7LQqWsld.png)

从上图可以看出每个区块包含**一个时间戳、一个随机数、一个对上一个区块的引用（即哈希）和上一区块生成以来发生的所有交易列表**。 随着时间推移就创建出了一个持续增长的区块链，它不断地更新，从而能够代表比特币账本的最新状态。

区块链上的区块（除了创世区块）都有一个hash pointer指向前一个区块，通过前一个区块整体来获取一个hash。如果一个区块被恶意修改，则后面的区块hash都会无法匹配。

区块链系统中有的节点只需保存部分区块，等到需要其他区块时，再向其他节点获取，可以通过hash来验证正确性。

#### Merkle tree

![](https://s2.loli.net/2022/11/28/fKRoqOe94NlCHLj.png)

比特币一个重要的可扩展特性是：它的区块存储在多层次数据结构中。 一个区块的哈希实际上只是区块头的哈希，区块头是一段约 200 字节的数据，包含时间戳、随机数、上个区块的哈希和默克尔树根的哈希，而默克尔树是一个存储了该区块所有交易的数据结构。

默克尔树是一种二叉树，由一组叶节点、一组中间节点和一个根节点构成。最下面是大量包含基础数据的叶节点，**每个中间节点是其两个子节点的哈希**，顶部的根节点也是其两个子节点的哈希。 默克尔树的目的是允许区块数据可以零散地传送：**节点可以从一个源下载区块头，从其它源下载相关树的一小部分，而依然能够确认所有的数据都是正确的**。

简化支付确认协议（SPV）允许另一种节点存在，这样的节点被称为“轻节点”，它下载区块头，使用区块头确认工作量证明，**然后只下载与其交易相关的默克尔树分支**。 这使得轻节点只要下载整个区块链的一小部分，就可以安全地确定任何一笔比特币交易的状态和帐户的当前余额。

### 协议

#### double spending attack


#### 